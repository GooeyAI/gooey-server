<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{{ title }}</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.png">


    <!-- Primary Meta Tags -->
    <title>Meta Tags â€” Preview, Edit and Generate</title>
    <meta name="title" content="{{ title }}">
    {% if description %}
        <meta name="description" content="{{ description }}">
    {% endif %}

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="{{ title }}">
    {% if description %}
        <meta property="og:description" content="{{ description }}">
    {% endif %}
    {% if image %}
        <meta property="og:image" content="{{ image }}">
    {% endif %}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ request.url }}">
    <meta property="twitter:title" content="{{ title }}">
    {% if description %}
        <meta property="twitter:description" content="{{ description }}">
    {% endif %}
    {% if image %}
        <meta property="twitter:image" content="{{ image }}">
    {% endif %}

    <link rel="stylesheet" href="/static/css/app.css">

    <style>
        ::-webkit-scrollbar {
            background: transparent;
            color: white;
            width: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: gray;
            border-radius: 100px;
        }

        iframe {
            overflow-y: scroll;
            border: 0;
            margin: 0;
            padding: 0;
            width: 100%;
        }

        .login-container {
            position: absolute;
            top: 25px;
            right: 25px;
            text-align: center;
        }
    </style>

</head>
<body>

<!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-K0XPWGWN9Y"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-K0XPWGWN9Y'); </script>

{% include 'header.html' %}

{% if request.user %}
    <div class="login-container">
        {{ request.user.display_name or request.user.email or request.user.phone_number }}
        <br>
        <a href="/logout?next={{ request.path }}">Signout</a>
    </div>
{% else %}
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <div id="g_id_onload"
         data-client_id="6678571001-hirtjjutehsmoi1jl0c0290kobdk8t8r.apps.googleusercontent.com"
         data-callback="handleCredentialResponse"
         data-auto_prompt="true">
    </div>

    <div class="login-container">
        <div class="g_id_signin"
             data-type="button"
             data-size="large"
             data-theme="filled_black"
             data-text="sign_in_with"
             data-shape="pill"
             data-logo_alignment="right">
        </div>
        <div style="height: 10px"></div>
        <a style="font-size: 15px; color: wheat" href="/login?next={{ request.path }}">More Options</a>
    </div>
{% endif %}

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
<script src="/static/js/auth.js"></script>

<iframe onload="onIframeLoaded(this)"
        src="{{ iframe_url }}"
        allow="clipboard-read; clipboard-write; accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking">
</iframe>

<script>
    function onIframeLoaded(iframe) {
        window.addEventListener('message', function (event) {
            switch (event.data.type) {
                case "GOOEY_SET_QUERY_PARAM":
                    let searchParams = new URLSearchParams(window.location.search);
                    for (let [key, value] of Object.entries(event.data.queryParams)) {
                        searchParams.set(key, value);
                    }
                    let url = new URL(window.location.href);
                    url.search = searchParams.toString();
                    history.pushState(null, '', url.toString());
                case "GOOEY_IFRAME_RESIZE":
                    iframe.style.height = `${event.data.height + 100}px`;
            }
        });
    }
</script>

</body>
</html>